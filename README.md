# Claude No Approve Bash

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

A Skill for Claude Code to execute complex bash commands without repeated approval prompts.

**Repository**: https://github.com/BiuBiuHu/claude-no-approve-bash

[中文版](README_zh.md)

---

## The Problem

When using Claude Code with complex bash commands (loops, pipes, command chaining), the system requires approval for each operation, reducing productivity.

## The Solution

Convert complex commands into scripts stored in `~/.claude-bin/`, enabling approval-free execution through permission configuration.

## Quick Start

### Method 1: One-line Install

```bash
curl -sSL https://raw.githubusercontent.com/BiuBiuHu/claude-no-approve-bash/main/install.sh | bash
```

### Method 2: Manual Install

```bash
# 1. Clone the repository
git clone https://github.com/BiuBiuHu/claude-no-approve-bash.git
cd claude-no-approve-bash

# 2. Copy Skill to your project
cp -r skill/no-approve-bash .claude/skills/

# 3. Configure permissions
```

### Configure Permissions

Add to `.claude/settings.local.json` in your project:

```json
{
  "permissions": {
    "allow": [
      "Bash(bash:*)",
      "Bash(~/.claude-bin/*)"
    ]
  }
}
```

### Verify Installation

```bash
# Test with a complex command
for dir in */; do echo "=== $dir ===" && ls "$dir" | head -3; done
```

Claude will automatically convert it to a script and execute without approval prompts.

## How It Works

```
User inputs complex command
       ↓
AI recognizes as complex (loops/pipes/chaining)
       ↓
Creates script in ~/.claude-bin/auto-xxx
       ↓
Executes directly (pre-authorized)
```

## Security Design

### Whitelist Mechanism

Only commands **already authorized in settings** can be combined:

| Category | Commands |
|----------|----------|
| Version Control | `git`, `gh` |
| Package Managers | `npm`, `npx`, `yarn`, `pnpm`, `python`, `pip` |
| File Operations | `ls`, `cat`, `grep`, `find`, `jq` |
| Network | `curl` |
| Deployment | `vercel`, `supabase` |

### High-risk Operations Still Require Approval

The following commands are **NOT auto-authorized**:

- `rm -rf /` / `rm -rf ~/` system directory deletion
- `dd if=/dev/` disk write
- `mkfs` formatting
- fork bombs and other destructive operations

## Usage Examples

### Example 1: Iterate Over Directories

**User Input**:
```
List first 3 files in each subdirectory
```

**AI Auto-converts**:
```bash
cat > ~/.claude-bin/auto-list-files << 'EOF'
#!/bin/bash
# List first 3 files in each subdirectory

for dir in */; do
    if [ -d "$dir" ]; then
        echo "=== $dir ==="
        ls "$dir" | head -3
    fi
done
EOF
chmod +x ~/.claude-bin/auto-list-files
~/.claude-bin/auto-list-files
```

### Example 2: Search in Multiple Files

**User Input**:
```
Count lines containing "TODO" in all .js files
```

**AI Auto-converts** and executes.

### Example 3: Git Operations

**User Input**:
```
Show git status for all subdirectories that are git repos
```

**AI Auto-converts**:
```bash
cat > ~/.claude-bin/auto-git-status << 'EOF'
#!/bin/bash
# Show git status for all git repos

for dir in */; do
    if [ -d "$dir/.git" ]; then
        echo "=== $dir ==="
        cd "$dir" && git status -s && cd ..
    fi
done
EOF
chmod +x ~/.claude-bin/auto-git-status
~/.claude-bin/auto-git-status
```

## Built-in Tools

| Script | Purpose |
|--------|---------|
| `make-script-safe` | Safe script creator with dangerous operation detection |
| `sync-settings` | Check project settings permissions |
| `security-audit` | Audit script security |

## Directory Structure

```
~/.claude-bin/                    # Scripts generated by AI
.claude/skills/no-approve-bash/   # Skill definition
├── SKILL.md
└── scripts/                       # Built-in tools
```

## Contributing

Issues and Pull Requests are welcome!

## License

[MIT](LICENSE)
